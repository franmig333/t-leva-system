<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>t-leva App</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>

<body>

    <div class="container" id="app">
        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-bar-bg">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div class="step-indicator">
                <span id="step1Label" style="color: var(--text-color)">Servicios</span>
                <span id="step2Label">Detalles</span>
            </div>
        </div>

        <header id="header">
            <!-- Dynamic Content -->
        </header>

        <!-- Dynamic Portfolio Section -->
        <section id="galeria-trabajos">
            <h3 class="section-title" style="text-align: center; margin-bottom: 1rem;">Casos de √âxito</h3>
            <div id="portfolio-grid">
                <!-- Injected via JS -->
            </div>
        </section>

        <form name="pedidos_t_leva" method="POST" data-netlify="true" id="wizardForm" enctype="multipart/form-data">
            <input type="hidden" name="form-name" value="pedidos_t_leva" />
            <input type="hidden" name="selected_services" id="selectedServicesInput">

            <!-- STEP 0: Identity (Always Visible or Part of Step 1? Prompt says "Start or End". Let's put it at Start/Step 1 but before services) -->
            <!-- Actually, let's make it part of Step 1 to keep flow simple but visually distinct at top -->
            <div class="wizard-step active" id="step1">

                <!-- IDENTITY SECTION -->
                <div class="service-section" style="margin-top: 0; margin-bottom: 2rem; border-top: none;">
                    <h3 class="section-title">üë§ Datos de la Empresa</h3>
                    <div class="form-group">
                        <label>Nombre de tu Empresa/Negocio <span class="info-icon"
                                data-tooltip="El nombre oficial con el que te conocen tus clientes.">‚ÑπÔ∏è</span></label>
                        <input type="text" name="nombre_negocio" placeholder="Ej: T-Leva Agency" required>
                    </div>
                    <div class="form-group">
                        <label>¬øPara cu√°ndo necesitas el proyecto? <span class="info-icon"
                                data-tooltip="Los proyectos urgentes pueden tener un recargo de prioridad.">‚ÑπÔ∏è</span></label>
                        <div class="select-wrapper">
                            <select name="project_deadline" required>
                                <option value="" disabled selected>Selecciona una opci√≥n</option>
                                <option value="Urgente">Urgente (Prioridad)</option>
                                <option value="1-2 Semanas">1-2 Semanas</option>
                                <option value="1 Mes">1 Mes</option>
                                <option value="Sin apuro">Sin apuro</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>¬øQui√©n llena el formulario?</label>
                        <input type="text" name="nombre_encuestado" placeholder="Tu nombre completo" required>
                    </div>
                    <div class="form-group">
                        <label>Cargo del encuestado</label>
                        <div class="select-wrapper">
                            <select name="cargo_encuestado" required>
                                <option value="" disabled selected>Selecciona...</option>
                                <option value="Due√±o/a">Due√±o/a</option>
                                <option value="Gerente">Gerente</option>
                                <option value="Asistente">Asistente</option>
                                <option value="Otro">Otro</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Correo electr√≥nico</label>
                        <input type="email" name="email_negocio" placeholder="contacto@tuempresa.com" required>
                    </div>
                </div>

                <h3 class="section-title">üöÄ Selecciona tus Servicios</h3>
                <div id="services-container" class="services-grid">
                    <!-- Loading Skeleton -->
                    <div style="grid-column: 1/-1; text-align: center; padding: 20px;">Cargando servicios...</div>
                </div>
                <div class="error-msg" id="serviceError">Por favor selecciona al menos un servicio.</div>
                <button type="button" class="action-btn" onclick="nextStep()">Continuar</button>
            </div>

            <!-- STEP 2: Questions -->
            <div class="wizard-step" id="step2">
                <div id="questions-container">
                    <!-- Dynamic Questions from Config -->
                </div>

                <div id="service-specific-container" style="margin-top: 2rem;">
                    <!-- Static Hidden Sections -->

                    <!-- LOGO BLOCK -->
                    <div id="details-logo" class="service-section hidden">
                        <h3 class="section-title">üé® Personalizaci√≥n de Logo & Branding</h3>

                        <fieldset class="form-fieldset">
                            <legend>Identidad & Nombre</legend>
                            <div class="form-group">
                                <label>¬øCu√°l es el nombre exacto de la marca? <span class="info-icon"
                                        data-tooltip="Respeta may√∫sculas y min√∫sculas exactas.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="logo_exact_name" placeholder="Ej: Caf√© Viena">
                            </div>
                            <div class="form-group">
                                <label>¬øTiene Slogan o frase? <span class="info-icon"
                                        data-tooltip="Ej: 'El mejor caf√©'. A veces el slogan va debajo del logo.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="logo_slogan" placeholder="Opcional">
                            </div>
                            <div class="form-group">
                                <label>¬øA qu√© se dedica el negocio en 1 sola frase? <span class="info-icon"
                                        data-tooltip="Para entender el rubro a la perfecci√≥n.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="logo_description"
                                    placeholder="Ej: Venta de ropa para beb√©s online">
                            </div>
                            <div class="form-group">
                                <label>¬øCu√°l es la historia detr√°s del nombre? <span class="info-icon"
                                        data-tooltip="A veces la historia nos da pistas para dibujar un √≠cono oculto.">‚ÑπÔ∏è</span></label>
                                <textarea name="logo_namestory" rows="2" placeholder="Origen del nombre..."></textarea>
                            </div>
                        </fieldset>

                        <fieldset class="form-fieldset">
                            <legend>Psicolog√≠a & Personalidad</legend>
                            <div class="form-group">
                                <label>¬øQu√© 3 palabras describen la personalidad de tu marca? <span class="info-icon"
                                        data-tooltip="Ej: Elegante, Divertida, R√°pida, Tradicional, Tecnol√≥gica.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="logo_personality_words"
                                    placeholder="Palabra 1, Palabra 2, Palabra 3">
                            </div>
                            <div class="form-group">
                                <label>Si tu marca fuera una persona famosa, ¬øqui√©n ser√≠a? <span class="info-icon"
                                        data-tooltip="Una forma divertida de entender la personalidad: ¬øEs como Steve Jobs o como Bad Bunny?">‚ÑπÔ∏è</span></label>
                                <input type="text" name="logo_celebrity" placeholder="Ej: Shakira (Alegre y global)">
                            </div>
                            <div class="form-group">
                                <label>¬øQu√© emoci√≥n quieres que sienta el cliente al ver el logo? <span
                                        class="info-icon"
                                        data-tooltip="Confianza, Hambre, Urgencia, Paz, Estatus.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="logo_emotion" placeholder="Ej: Seguridad y Confianza">
                            </div>
                            <div class="form-group">
                                <label>¬øQu√© colores te representan? <span class="info-icon"
                                        data-tooltip="Colores que sientes que van con la vibra del negocio.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="logo_colors_like" placeholder="Ej: Azul marino y Oro">
                            </div>
                            <div class="form-group">
                                <label>¬øQu√© colores ODIAS o NUNCA usar√≠as? <span class="info-icon"
                                        data-tooltip="Vital para no perder tiempo con dise√±os que rechazar√°s.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="logo_colors_hate" placeholder="Ej: Nada de rosado ni ne√≥n">
                            </div>
                        </fieldset>

                        <fieldset class="form-fieldset">
                            <legend>Est√©tica & Preferencias</legend>
                            <div class="form-group">
                                <label>¬øQu√© tipo de logo prefieres? <span class="info-icon"
                                        data-tooltip="Solo letras, Letras + √çcono, o un Emblema/Escudo.">‚ÑπÔ∏è</span></label>
                                <div class="select-wrapper">
                                    <select name="logo_type_pref">
                                        <option value="Letras + √çcono (Imagotipo)">Letras + √çcono</option>
                                        <option value="Solo Letras (Logotipo)">Solo Letras</option>
                                        <option value="Emblema/Escudo">Emblema/Escudo</option>
                                        <option value="No s√©, prop√≥nganme">No s√©, prop√≥nganme</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>¬øHay alg√∫n s√≠mbolo que te gustar√≠a incluir? <span class="info-icon"
                                        data-tooltip="Ej: Unas tijeras, una corona, una letra espec√≠fica.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="logo_symbol_wish" placeholder="Me gustar√≠a ver un le√≥n...">
                            </div>
                            <div class="form-group">
                                <label>¬øHay alg√∫n s√≠mbolo CLICH√â que no quieres ver? <span class="info-icon"
                                        data-tooltip="Ej: Si eres dentista, tal vez ya no quieres el t√≠pico dibujo del diente.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="logo_cliche_avoid" placeholder="Evitar...">
                            </div>
                            <div class="form-group">
                                <label>Nombra 3 marcas famosas cuya imagen te encante <span class="info-icon"
                                        data-tooltip="Para entender tu est√°ndar visual (Apple, Nike, CocaCola...).">‚ÑπÔ∏è</span></label>
                                <input type="text" name="logo_visual_benchmarks" placeholder="Marcas referentes...">
                            </div>
                            <div class="form-group">
                                <label>Sube referencias visuales (Fotos) <span class="info-icon"
                                        data-tooltip="Mu√©stranos fotos de logos que te gusten para afinar la punter√≠a.">‚ÑπÔ∏è</span></label>
                                <label class="file-upload-wrapper">
                                    <input type="file" name="logo_files" multiple>
                                    <span>üìÇ Arrastra o clic aqu√≠</span>
                                </label>
                            </div>
                        </fieldset>

                        <fieldset class="form-fieldset">
                            <legend>Mercado & Entregables</legend>
                            <div class="form-group">
                                <label>¬øA qui√©n le vendes? (P√∫blico Objetivo) <span class="info-icon"
                                        data-tooltip="Un logo para ni√±os se dise√±a muy distinto a un logo para abogados.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="logo_target"
                                    placeholder="Edad, g√©nero, nivel socioecon√≥mico...">
                            </div>
                            <div class="form-group">
                                <label>¬øD√≥nde se usar√° m√°s este logo? <span class="info-icon"
                                        data-tooltip="Redes sociales, Letreros gigantes, Bordado en uniformes, Empaques.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="logo_usage_primary" placeholder="Principalmente en...">
                            </div>
                            <div class="form-group">
                                <label>¬øTienen logos anteriores? <span class="info-icon"
                                        data-tooltip="Para ver si hay que mantener la esencia o hacer un cambio radical.">‚ÑπÔ∏è</span></label>
                                <div class="select-wrapper">
                                    <select name="logo_has_previous">
                                        <option value="No, es nuevo">No, es nuevo</option>
                                        <option value="S√≠, pero quiero cambiar todo">S√≠, pero quiero cambiar todo
                                        </option>
                                        <option value="S√≠, quiero modernizarlo">S√≠, quiero modernizarlo</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>¬øNecesitas un Manual de Marca? <span class="info-icon"
                                        data-tooltip="Un documento PDF que dice c√≥mo usar el logo para que otros no lo deformen.">‚ÑπÔ∏è</span></label>
                                <div class="checkbox-wrapper">
                                    <label><input type="checkbox" name="logo_deliverables" value="Manual de Marca"> S√≠,
                                        lo necesito</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>¬øSe necesita registrar legalmente? <span class="info-icon"
                                        data-tooltip="Para asegurarnos de no usar elementos pre-fabricados.">‚ÑπÔ∏è</span></label>
                                <div class="checkbox-wrapper">
                                    <label><input type="checkbox" name="logo_legal_reg" value="S√≠"> S√≠, voy a
                                        registrarlo</label>
                                </div>
                            </div>
                        </fieldset>
                        <div class="form-group">
                            <label>Comentarios adicionales</label>
                            <textarea name="logo_comentarios" rows="3" placeholder="Algo m√°s..."></textarea>
                        </div>
                    </div>

                    <!-- WEB BLOCK -->
                    <div id="details-web" class="service-section hidden">
                        <h3 class="section-title">üåê Detalles Web & Apps</h3>

                        <fieldset class="form-fieldset">
                            <legend>Datos T√©cnicos & Dominio</legend>
                            <div class="form-group">
                                <label>¬øQu√© nombre de dominio deseas? <span class="info-icon"
                                        data-tooltip="Es la direcci√≥n de tu web. Ej: misu√±as.com. Si ya lo tienes, ponlo; si no, pon 3 opciones.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="web_domain_preferences"
                                    placeholder="Opci√≥n 1, Opci√≥n 2, Opci√≥n 3...">
                            </div>
                            <div class="form-group">
                                <label>¬øYa tienes contratado el Hosting? <span class="info-icon"
                                        data-tooltip="Es el espacio digital donde se guardan tus fotos y textos. Si no tienes, nosotros lo gestionamos.">‚ÑπÔ∏è</span></label>
                                <div class="select-wrapper">
                                    <select name="web_hosting_status">
                                        <option value="No, gestionenlo ustedes">No, gesti√≥nenlo ustedes</option>
                                        <option value="S√≠, ya tengo">S√≠, ya tengo</option>
                                        <option value="No estoy seguro">No estoy seguro</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>¬øEn qu√© idiomas estar√° la web? <span class="info-icon"
                                        data-tooltip="¬øSolo espa√±ol o tambi√©n ingl√©s para el p√∫blico extranjero?">‚ÑπÔ∏è</span></label>
                                <input type="text" name="web_languages" placeholder="Ej: Espa√±ol e Ingl√©s">
                            </div>
                            <div class="form-group">
                                <label>¬øPara cu√°ndo necesitas que la web est√© al aire? <span class="info-icon"
                                        data-tooltip="Los proyectos urgentes pueden tener un recargo de prioridad.">‚ÑπÔ∏è</span></label>
                                <div class="select-wrapper">
                                    <select name="web_deadline">
                                        <option value="Urgente">Urgente</option>
                                        <option value="1 Mes">1 Mes</option>
                                        <option value="Sin apuro">Sin apuro</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Presupuesto estimado para la web <span class="info-icon"
                                        data-tooltip="Esto nos ayuda a no ofrecerte un Ferrari si buscas un buen auto utilitario, o viceversa.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="web_budget" placeholder="Ej: $500 - $1000">
                            </div>
                        </fieldset>

                        <fieldset class="form-fieldset">
                            <legend>Estrategia & Mercado</legend>
                            <div class="form-group">
                                <label>¬øCu√°l es el objetivo #1 de la web? <span class="info-icon"
                                        data-tooltip="Ej: Vender productos, que la gente agende citas, o solo dar informaci√≥n y ganar prestigio.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="web_goal_primary" placeholder="Ej: Agendar Citas">
                            </div>
                            <div class="form-group">
                                <label>¬øQui√©n es tu cliente ideal? <span class="info-icon"
                                        data-tooltip="Edad, qu√© le gusta, c√≥mo habla. Esto define si el dise√±o debe ser serio, juvenil, de lujo, etc.">‚ÑπÔ∏è</span></label>
                                <textarea name="web_target_audience" rows="2"
                                    placeholder="Describe a tu cliente ideal..."></textarea>
                            </div>
                            <div class="form-group">
                                <label>Nombra 3 competidores a los que quieres superar <span class="info-icon"
                                        data-tooltip="Analizaremos qu√© hacen bien para nosotros hacerlo mucho mejor.">‚ÑπÔ∏è</span></label>
                                <textarea name="web_competitors" rows="2" placeholder="Links o nombres..."></textarea>
                            </div>
                            <div class="form-group">
                                <label>Menciona 2 p√°ginas web que te gusten mucho <span class="info-icon"
                                        data-tooltip="No importa si no son de tu rubro, nos ayuda a entender tu gusto visual.">‚ÑπÔ∏è</span></label>
                                <textarea name="web_visual_references" rows="2" placeholder="Links..."></textarea>
                            </div>
                            <div class="form-group">
                                <label>¬øCu√°l es tu ventaja √∫nica? (¬øPor qu√© elegirte a ti?) <span class="info-icon"
                                        data-tooltip="Este ser√° el t√≠tulo principal que ver√° la gente al entrar.">‚ÑπÔ∏è</span></label>
                                <textarea name="web_usp" rows="2"
                                    placeholder="Somos los m√°s r√°pidos, o los m√°s baratos, o los √∫nicos que..."></textarea>
                            </div>
                        </fieldset>

                        <fieldset class="form-fieldset">
                            <legend>Contenido & Estructura</legend>
                            <div class="form-group">
                                <label>¬øQu√© p√°ginas internas necesitas? <span class="info-icon"
                                        data-tooltip="Ej: Inicio, Nosotros, Servicios, Galer√≠a, Contacto, Blog.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="web_pages_list" placeholder="Lista las secciones...">
                            </div>
                            <div class="form-group">
                                <label>¬øTienes los textos redactados? <span class="info-icon"
                                        data-tooltip="Si no los tienes, podemos ofrecerte el servicio de redacci√≥n profesional / Copywriting.">‚ÑπÔ∏è</span></label>
                                <div class="select-wrapper">
                                    <select name="web_copywriting_status">
                                        <option value="S√≠, tengo todo">S√≠, tengo todo</option>
                                        <option value="No, necesito ayuda">No, necesito ayuda</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>¬øTienes fotograf√≠as profesionales de tu negocio? <span class="info-icon"
                                        data-tooltip="Una web premium necesita fotos premium. Si no tienes, usamos bancos de im√°genes.">‚ÑπÔ∏è</span></label>
                                <div class="select-wrapper">
                                    <select name="web_photos_status">
                                        <option value="S√≠, tengo fotos pro">S√≠, tengo fotos pro</option>
                                        <option value="Tengo fotos caseras">Tengo fotos caseras</option>
                                        <option value="Necesito banco de im√°genes">Necesito banco de im√°genes</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>¬øTienes el Manual de Marca y Logo listo? <span class="info-icon"
                                        data-tooltip="Para usar tus colores y tipograf√≠as exactas.">‚ÑπÔ∏è</span></label>
                                <div class="select-wrapper">
                                    <select name="web_brand_manual">
                                        <option value="S√≠, tengo todo">S√≠, tengo todo</option>
                                        <option value="Solo tengo el logo">Solo tengo el logo</option>
                                        <option value="No tengo nada">No tengo nada</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Sube tus archivos (Logo/Fotos) <span class="info-icon"
                                        data-tooltip="Sube lo que tengas disponible.">‚ÑπÔ∏è</span></label>
                                <label class="file-upload-wrapper">
                                    <input type="file" name="web_files" multiple>
                                    <span>üìÇ Arrastra o clic aqu√≠</span>
                                </label>
                            </div>
                        </fieldset>

                        <fieldset class="form-fieldset">
                            <legend>Funcionalidades & Integraciones</legend>
                            <div class="form-group">
                                <label>Funcionalidades Clave <span class="info-icon"
                                        data-tooltip="Selecciona lo que realmente necesitas.">‚ÑπÔ∏è</span></label>
                                <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                                    <label style="display: flex; align-items: center; gap: 5px; font-size: 14px;">
                                        <input type="checkbox" name="web_features" value="Citas/Reservas"
                                            style="width: auto; margin: 0;"> Citas/Reservas ‚ÑπÔ∏è
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 5px; font-size: 14px;">
                                        <input type="checkbox" name="web_features" value="Tienda Online"
                                            style="width: auto; margin: 0;"> Tienda Online ‚ÑπÔ∏è
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 5px; font-size: 14px;">
                                        <input type="checkbox" name="web_features" value="Chat/WhatsApp"
                                            style="width: auto; margin: 0;"> Chat/WhatsApp ‚ÑπÔ∏è
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 5px; font-size: 14px;">
                                        <input type="checkbox" name="web_features" value="CRM"
                                            style="width: auto; margin: 0;"> Conexi√≥n CRM ‚ÑπÔ∏è
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 5px; font-size: 14px;">
                                        <input type="checkbox" name="web_features" value="Social Feed"
                                            style="width: auto; margin: 0;"> Feed Redes ‚ÑπÔ∏è
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 5px; font-size: 14px;">
                                        <input type="checkbox" name="web_features" value="Newsletter"
                                            style="width: auto; margin: 0;"> Newsletter ‚ÑπÔ∏è
                                    </label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Comentarios adicionales</label>
                                <textarea name="web_comentarios" rows="3" placeholder="Detalles extra..."></textarea>
                            </div>
                        </fieldset>
                    </div>

                    <!-- BIO BLOCK -->
                    <div id="details-bio" class="service-section hidden">
                        <h3 class="section-title">üîó Bio Site & Links</h3>

                        <fieldset class="form-fieldset">
                            <legend>Acci√≥n & Contacto</legend>
                            <div class="form-group">
                                <label>¬øCu√°l es tu "Llamado a la Acci√≥n" (CTA) principal? <span class="info-icon"
                                        data-tooltip="El bot√≥n gigante que queremos que toquen. Ej: 'Agendar Cita'.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="bio_cta_main" placeholder="Ej: Agendar Cita">
                            </div>
                            <div class="form-group">
                                <label>N√∫mero de WhatsApp de contacto directo <span class="info-icon"
                                        data-tooltip="Se abrir√° un chat directo con un mensaje pre-armado.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="bio_whatsapp" placeholder="+593 99 999 9999" required>
                            </div>
                            <div class="form-group">
                                <label>¬øMensaje pre-armado para el WhatsApp? <span class="info-icon"
                                        data-tooltip="Ej: 'Hola, vi su Bio y quiero info de...'">‚ÑπÔ∏è</span></label>
                                <input type="text" name="bio_wa_message" placeholder="Texto por defecto...">
                            </div>
                            <div class="form-group">
                                <label>¬øQuieres mostrar tus horarios de atenci√≥n? <span class="info-icon"
                                        data-tooltip="Para que sepan a qu√© hora escribirte.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="bio_schedule" placeholder="Ej: Lun-Vie 9am-6pm">
                            </div>
                        </fieldset>

                        <fieldset class="form-fieldset">
                            <legend>Redes & Ubicaci√≥n</legend>
                            <div class="form-group">
                                <label>¬øCu√°les son tus redes sociales secundarias? <span class="info-icon"
                                        data-tooltip="Links de TikTok, Facebook, YouTube, LinkedIn para poner iconos.">‚ÑπÔ∏è</span></label>
                                <textarea name="bio_socials_list" rows="2" placeholder="Pega tus links..."></textarea>
                            </div>
                            <div class="form-group">
                                <label>¬øQuieres incluir tu ubicaci√≥n / Google Maps? <span class="info-icon"
                                        data-tooltip="Muy importante para negocios f√≠sicos como el sal√≥n de u√±as.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="bio_location_link" placeholder="Link de Maps o Direcci√≥n">
                            </div>
                            <div class="form-group">
                                <label>¬øLinktree o Dominio Propio? <span class="info-icon"
                                        data-tooltip="¬øQuieres que sea links.miempresa.com o un link gen√©rico?">‚ÑπÔ∏è</span></label>
                                <div class="select-wrapper">
                                    <select name="bio_domain_pref">
                                        <option value="Dominio Propio (M√°s Pro)">Dominio Propio (M√°s Pro)</option>
                                        <option value="Link Gen√©rico">Link Gen√©rico</option>
                                    </select>
                                </div>
                            </div>
                        </fieldset>

                        <fieldset class="form-fieldset">
                            <legend>Contenido & Visual</legend>
                            <div class="form-group">
                                <label>¬øPrefieres foto de perfil tuya o el logo? <span class="info-icon"
                                        data-tooltip="Para marcas personales es mejor la foto, para empresas el logo.">‚ÑπÔ∏è</span></label>
                                <label class="file-upload-wrapper">
                                    <input type="file" name="bio_profile_pic">
                                    <span>üë§ Subir Foto/Logo</span>
                                </label>
                            </div>
                            <div class="form-group">
                                <label>¬øFondo de la Bio? <span class="info-icon"
                                        data-tooltip="Color s√≥lido, degradado, foto tuya de fondo o un video corto en bucle.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="bio_bg_pref" placeholder="Ej: Foto oscura de fondo">
                            </div>
                            <div class="form-group">
                                <label>¬øBiograf√≠a corta (Texto de introducci√≥n)? <span class="info-icon"
                                        data-tooltip="Un p√°rrafo de 2 l√≠neas sobre lo que haces.">‚ÑπÔ∏è</span></label>
                                <textarea name="bio_intro_text" rows="2" placeholder="Hola, somos..."></textarea>
                            </div>
                            <div class="form-group">
                                <label>¬øQuieres incluir un Cat√°logo en PDF o Men√∫? <span class="info-icon"
                                        data-tooltip="Podemos poner un bot√≥n para descargar tu lista de precios.">‚ÑπÔ∏è</span></label>
                                <label class="checkbox-wrapper"><input type="checkbox" name="bio_feat_catalog"
                                        value="S√≠"> S√≠, incluir bot√≥n de descarga</label>
                            </div>
                            <div class="form-group">
                                <label>¬øEstilo de los botones? <span class="info-icon"
                                        data-tooltip="Redondeados, cuadrados, con sombra, minimalistas.">‚ÑπÔ∏è</span></label>
                                <input type="text" name="bio_btn_style" placeholder="Ej: Redondeados con borde">
                            </div>
                        </fieldset>

                        <fieldset class="form-fieldset">
                            <legend>Funciones Avanzadas</legend>
                            <div class="form-group">
                                <label>Activaciones Especiales <span class="info-icon"
                                        data-tooltip="Selecciona extras.">‚ÑπÔ∏è</span></label>
                                <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                                    <label style="font-size: 14px;"><input type="checkbox" name="bio_extras"
                                            value="Formulario Email"> Captura Email ‚ÑπÔ∏è</label>
                                    <label style="font-size: 14px;"><input type="checkbox" name="bio_extras"
                                            value="Video Embed"> Video YouTube/TikTok ‚ÑπÔ∏è</label>
                                    <label style="font-size: 14px;"><input type="checkbox" name="bio_extras"
                                            value="Spotify"> M√∫sica Spotify ‚ÑπÔ∏è</label>
                                    <label style="font-size: 14px;"><input type="checkbox" name="bio_extras"
                                            value="Testimonios"> Testimonios ‚ÑπÔ∏è</label>
                                    <label style="font-size: 14px;"><input type="checkbox" name="bio_extras"
                                            value="Pixel FB"> Pixel Facebook ‚ÑπÔ∏è</label>
                                    <label style="font-size: 14px;"><input type="checkbox" name="bio_extras"
                                            value="Venta Directa"> Venta Producto √önico ‚ÑπÔ∏è</label>
                                    <label style="font-size: 14px;"><input type="checkbox" name="bio_extras"
                                            value="QR Print"> QR para Imprimir ‚ÑπÔ∏è</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>¬øFrecuencia de actualizaci√≥n? <span class="info-icon"
                                        data-tooltip="¬øCambiar√°s los links todos los d√≠as o una vez al a√±o?">‚ÑπÔ∏è</span></label>
                                <input type="text" name="bio_maintenance" placeholder="Ej: Una vez al mes">
                            </div>
                        </fieldset>

                        <div class="form-group">
                            <label>Comentarios extra sobre tu Bio</label>
                            <textarea name="bio_comentarios" rows="2"></textarea>
                        </div>
                    </div>
                </div>

                <div style="display: flex; gap: 10px; margin-top: 2rem;">
                    <button type="button" class="action-btn"
                        style="background-color: transparent; border: 1px solid var(--input-bg); color: #b2bec3;"
                        onclick="prevStep()">Atr√°s</button>
                    <button type="submit" class="action-btn" id="submitBtn">Enviar Solicitud</button>
                </div>
            </div>
        </form>

        <a href="/admin/" class="admin-link">üîí Acceso Administrador</a>
    </div>

    <!-- Success Modal -->
    <div id="successModal">
        <div class="modal-content">
            <span class="modal-icon">üéâ</span>
            <div class="modal-title">¬°Solicitud Recibida!</div>
            <div class="modal-text">Has tomado la mejor decisi√≥n para tu negocio. Has elegido a un excelente equipo de
                trabajo para llevar tu proyecto al siguiente nivel.</div>
            <div class="modal-subtext">
                <div class="loader-spinner"></div>
                Redirigiendo a WhatsApp en unos segundos...
            </div>
        </div>
    </div>

    <!-- Configurado para el usuario franmig33 -->
    <script>
        let currentStep = 1;
        const totalSteps = 2;
        const selectedServices = new Set();

        document.addEventListener('DOMContentLoaded', async () => {
            updateProgress();

            updateProgress();

            const form = document.getElementById('wizardForm');
            form.addEventListener('submit', handleSubmit);


            // Redirect to admin if login happens on this page
            if (window.netlifyIdentity) {
                window.netlifyIdentity.on("init", user => {
                    if (!user) {
                        window.netlifyIdentity.on("login", () => {
                            document.location.href = "/admin/";
                        });
                    }
                });
            }

            try {
                const response = await fetch('/_data/config.json');
                if (!response.ok) throw new Error('Error fetching config');
                const data = await response.json();
                renderApp(data);
                window.appConfig = data;
            } catch (error) {
                console.error(error);
                document.getElementById('header').innerHTML = '<h2>Error de conexi√≥n</h2>';
            }
        });

        function renderApp(data) {
            // Header
            // Header
            let logoHtml = '';
            if (data.logo_imagen) {
                logoHtml = `<img id="dynamic-logo" class="app-logo" src="${data.logo_imagen}" alt="Logo Empresa" />`;
            }

            document.getElementById('header').innerHTML = `
                ${logoHtml}
                <h1>${data.title}</h1>
                <p class="subtitle">${data.subtitle}</p>
            `;

            // Portfolio Logic
            const gallerySection = document.getElementById('galeria-trabajos');
            const galleryGrid = document.getElementById('portfolio-grid');

            if (data.mostrar_galeria === true && data.portafolio && data.portafolio.length > 0) {
                gallerySection.style.display = 'block';
                galleryGrid.innerHTML = data.portafolio.map(item => `
                    <div class="portfolio-item">
                        <img src="${item.imagen}" alt="${item.titulo || 'Proyecto'}">
                        ${item.titulo ? `<div class="portfolio-title-overlay">${item.titulo}</div>` : ''}
                    </div>
                `).join('');
            } else {
                gallerySection.style.display = 'none';
            }

            // Apply Dynamic Colors
            if (data.apariencia) {
                const root = document.documentElement;
                if (data.apariencia.color_fondo_app) root.style.setProperty('--bg-color', data.apariencia.color_fondo_app);
                if (data.apariencia.color_primario) {
                    root.style.setProperty('--accent-color', data.apariencia.color_primario);
                }
                if (data.apariencia.color_texto) root.style.setProperty('--text-color', data.apariencia.color_texto);
            }

            // Services
            const servicesContainer = document.getElementById('services-container');
            servicesContainer.innerHTML = ''; // Clear skeleton

            if (data.services) {
                data.services.forEach(service => {
                    const btn = document.createElement('div');
                    btn.className = 'service-card';
                    btn.textContent = service.name;
                    btn.onclick = () => toggleService(btn, service.name);
                    servicesContainer.appendChild(btn);
                });
            }

            // Questions
            const questionsContainer = document.getElementById('questions-container');
            if (data.questions) {
                let html = '';
                data.questions.forEach(q => {
                    const id = q.name || q.label.toLowerCase().replace(/\s+/g, '-');
                    html += `<div class="form-group">
                        <label for="${id}">${q.label}</label>
                        ${q.type === 'textarea'
                            ? `<textarea id="${id}" name="${id}" rows="4" required></textarea>`
                            : `<input type="${q.type}" id="${id}" name="${id}" required>`}
                    </div>`;
                });
                questionsContainer.innerHTML = html;
            }
        }

        function toggleService(element, name) {
            element.classList.toggle('selected');
            if (selectedServices.has(name)) {
                selectedServices.delete(name);
            } else {
                selectedServices.add(name);
            }
            document.getElementById('selectedServicesInput').value = Array.from(selectedServices).join(', ');

            if (selectedServices.size > 0) {
                document.getElementById('serviceError').style.display = 'none';
            }
            // Trigger Conditional Logic
            updateConditionals();
        }

        function updateConditionals() {
            // Helper function to safely toggle visibility
            const toggleSection = (sectionId, isVisible) => {
                const section = document.getElementById(sectionId);
                if (section) {
                    if (isVisible) {
                        section.classList.remove('hidden');
                        // Enable all inputs inside to ensure they are submitted
                        section.querySelectorAll('input, select, textarea').forEach(el => el.disabled = false);
                    } else {
                        section.classList.add('hidden');
                        // Disable inputs inside so they don't block validation or send empty data for unselected services
                        section.querySelectorAll('input, select, textarea').forEach(el => el.disabled = true);
                    }
                }
            };

            // Apply logic for each service
            toggleSection('details-logo', selectedServices.has('Logo'));
            toggleSection('details-web', selectedServices.has('Web'));
            toggleSection('details-bio', selectedServices.has('Bio'));
        }

        window.nextStep = function () {
            if (currentStep === 1) {
                if (selectedServices.size === 0) {
                    document.getElementById('serviceError').style.display = 'block';
                    // Shake animation effect
                    const btn = document.querySelector('#step1 .action-btn');
                    btn.style.transform = 'translateX(5px)';
                    setTimeout(() => btn.style.transform = 'translateX(0)', 100);
                    return;
                }
            }

            if (currentStep < totalSteps) {
                document.getElementById(`step${currentStep}`).classList.remove('active');
                currentStep++;
                document.getElementById(`step${currentStep}`).classList.add('active');
                updateProgress();
            }
        };

        window.prevStep = function () {
            if (currentStep > 1) {
                document.getElementById(`step${currentStep}`).classList.remove('active');
                currentStep--;
                document.getElementById(`step${currentStep}`).classList.add('active');
                updateProgress();
            }
        };

        async function handleSubmit(e) {
            e.preventDefault();
            const form = e.target;
            const btn = document.getElementById('submitBtn');
            btn.innerText = "Procesando...";
            btn.disabled = true;

            // SHOW MODAL IMMEDIATELY
            const modal = document.getElementById('successModal');
            modal.style.display = 'flex';
            // Slight delay to allow display flex to apply before adding class for opacity transition
            setTimeout(() => {
                modal.classList.add('show');
            }, 10);

            const formData = new FormData(form);

            try {
                // 1. Send to Netlify (Background)
                fetch('/', {
                    method: 'POST',
                    body: formData
                }).catch(err => console.error("Netlify Save Error:", err)); // Log but don't stop flow

                // 2. Build WhatsApp Message
                const company = document.querySelector('input[name="nombre_negocio"]')?.value || document.getElementById('company_name')?.value || "Cliente";
                const respondent = document.querySelector('input[name="nombre_encuestado"]')?.value || "";
                const deadline = document.querySelector('select[name="project_deadline"]')?.value || "No especificado";

                let message = `Hola T-Leva, soy ${respondent} de ${company}.%0A`;
                message += `üìÖ Plazo: ${deadline}%0A%0A`;
                message += `üöÄ Solicitud de Proyecto:%0A`;

                if (selectedServices.has('Web')) {
                    const domain = document.querySelector('input[name="web_domain_preferences"]')?.value || "No definido";
                    const goal = document.getElementById('web_goal').value;
                    message += `üåê WEB: Objetivo ${goal}. Dominio: ${domain}.%0A`;
                }

                if (selectedServices.has('Logo')) {
                    const audience = document.querySelector('select[name="logo_target_audience"]')?.value || "No especificado";
                    message += `üé® LOGO: P√∫blico ${audience}.%0A`;
                }

                if (selectedServices.has('Bio')) {
                    const bioObjective = document.querySelector('select[name="bio_main_objective"]')?.value || "";
                    message += `üîó BIO SITE: Objetivo ${bioObjective}.%0A`;
                }

                // Check for files
                const hasFiles = (formData.get('logo_files') && formData.get('logo_files').size > 0) ||
                    (formData.get('web_files') && formData.get('web_files').size > 0) ||
                    (formData.get('bio_profile_pic') && formData.get('bio_profile_pic').size > 0);

                if (hasFiles) {
                    message += `%0A‚úÖ He subido mis archivos de referencia en el formulario.`;
                }

                // 3. WAIT and Redirect
                const WA_NUMBER = "593984083776";

                setTimeout(() => {
                    window.open(`https://wa.me/${WA_NUMBER}?text=${message}`, '_blank');
                    // Optional: Reset form or close modal after redirect?
                    // For now, leave modal open as a success state
                }, 3500);

            } catch (error) {
                console.error(error);
                // Hide modal if critical logic fails before the timeout set up? 
                // Actually the fetch is async specific so we are mostly safe.
                modal.classList.remove('show');
                setTimeout(() => modal.style.display = 'none', 300);

                btn.innerText = "Error - Intenta de nuevo";
                btn.disabled = false;
            }
        }

        function updateProgress() {
            const percent = ((currentStep - 1) / (totalSteps - 1)) * 100; // 0% or 100% since 2 steps
            // But visual preference usually starts at 50% for step 1? 
            // Let's make Step 1 = 50%, Step 2 = 100% for better visual feedback
            const visualPercent = (currentStep / totalSteps) * 100;

            document.getElementById('progressBar').style.width = `${visualPercent}%`;

            // Update labels styles
            if (currentStep === 2) {
                document.getElementById('step2Label').style.color = 'var(--text-color)';
            } else {
                document.getElementById('step2Label').style.color = '#b2bec3';
            }
        }
    </script>
</body>

</html>